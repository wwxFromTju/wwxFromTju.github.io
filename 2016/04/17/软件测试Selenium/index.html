<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>软件测试Selenium | 王小惟的秘密小窝</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="tju学生，会点c++，Java，Python，Matlab，R。热爱机器学习，正在学习中。">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="软件测试Selenium | 王小惟的秘密小窝">
    <meta name="twitter:description" content="tju学生，会点c++，Java，Python，Matlab，R。热爱机器学习，正在学习中。">

    <meta property="og:type" content="article">
    <meta property="og:title" content="软件测试Selenium | 王小惟的秘密小窝">
    <meta property="og:description" content="tju学生，会点c++，Java，Python，Matlab，R。热爱机器学习，正在学习中。">

    
    <meta name="author" content="wwx">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/favicon.png">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="王小惟的秘密小窝" href="/atom.xml">
    

    <link rel="canonical" href="http://yoursite.com/2016/04/17/软件测试Selenium/"/>

    
    <link rel="author" href="https://plus.google.com/u/0/113186566531295618095"/>
    
</head>

<body class="home-template no-js">

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 王小惟的秘密小窝 的主页"><img src="/images/logo.jpg" width="80" alt="王小惟的秘密小窝 logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for 王小惟的秘密小窝">王小惟的秘密小窝</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">关于生活和科技的闲言碎语</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">tju学生，会点c++，Java，Python，Matlab，R。热爱机器学习，正在学习中。</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="访问博客" class="blog-button">博客</a></li>
            
              <li class="navigation__item"><a href="/projects">项目作品</a></li>
            
              <li class="navigation__item"><a href="/aboutme">关于我</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  

  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/wwxFromTju" title="查看我的GitHub主页" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  
  <li class="navigation__item">
    <a href="https://plus.google.com/u/0/113186566531295618095" title="Google+" target="_blank">
      <i class='social fa fa-google-plus-square'></i>
      <span class="label">Google+</span>
    </a>
  </li>


<!-- Facebook -->

  
<!-- Twitter -->

  

  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>



  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-blue"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2016-04-17T05:13:01.000Z" class="post-list__meta--date date">2016-04-17</time> &#8226; <span class="post-meta__tags tags">于&nbsp;</span>
    </div>
    <h1 class="post-title">软件测试Selenium</h1>
  </header>

  <section class="post">
    <h3 id="实验内容："><a href="#实验内容：" class="headerlink" title="实验内容："></a>实验内容：</h3><ul>
<li>安装SeleniumIDE插件</li>
<li>学会使用SeleniumIDE录制脚本和导出脚本</li>
<li>访问<a href="http://www.ncfxy.com使用学号登录系统（账户名为学号，密码为学号后6位），进入系统后可以看到该用户的邮箱。" target="_blank" rel="external">http://www.ncfxy.com使用学号登录系统（账户名为学号，密码为学号后6位），进入系统后可以看到该用户的邮箱。</a></li>
<li>编写Selenium Java WebDriver程序，测试info.csv表格中的学号和邮箱的对应关系是否正确。</li>
<li>将测试代码提交到github上。</li>
</ul>
<h3 id="实验过程："><a href="#实验过程：" class="headerlink" title="实验过程："></a>实验过程：</h3><ul>
<li>在firefox的插件安装网站上查找Selenium，点击安装即可：<br><img src="/images/selenium/tupian1.png" alt=""></li>
<li><p>使用selenium简单操作一下，想要导出相应语言的脚本，如下图所示：<br><img src="/images/selenium/tupian2.png" alt=""><br><img src="/images/selenium/tupian3.png" alt=""></p>
</li>
<li><p>访问<a href="http://www.ncfxy.com，并使用学号登陆系统：" target="_blank" rel="external">http://www.ncfxy.com，并使用学号登陆系统：</a><br><img src="/images/selenium/tupian4.png" alt=""><br><img src="/images/selenium/tupian5.png" alt=""></p>
</li>
<li><p>编写Selenium Java WebDriver程序，测试info.csv表格中的学号和邮箱对应是否正确，代码如下：</p>
</li>
</ul>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>~/学习/大三下/softwaretest/src/TestTheEmail.java.html</title>
<meta name="Generator" content="Vim/7.4">
<meta name="plugin-version" content="vim7.4_v1">
<meta name="syntax" content="java">
<meta name="settings" content="number_lines,use_css,pre_wrap,no_foldcolumn,expand_tabs,line_ids,prevent_copy=">
<meta name="colorscheme" content="molokai">
<style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #f8f8f2; background-color: #1b1d1e; }
body { font-family: monospace; color: #1b1d1e;  }
* { font-size: 1em; }
.Conditional { color: #f92672; font-weight: bold; }
.Repeat { color: #f92672; font-weight: bold; }
.Operator { color: #f92672; }
.Exception { color: #a6e22e; font-weight: bold; }
.PreProc { color: #a6e22e; }
.Type { color: #66d9ef; }
.String { color: #e6db74; }
.Number { color: #ae81ff; }
.StorageClass { color: #fd971f; font-style: italic; }
.SpecialChar { color: #f92672; font-weight: bold; }
.SpecialComment { color: #7e8e91; font-weight: bold; }
.LineNr { color: #465457; background-color: #232526; padding-bottom: 1px; }
.Comment { color: #7e8e91; }
.Constant { color: #ae81ff; font-weight: bold; }
-->
</style>

<script type='text/javascript'>
<!--

/* function to open any folds containing a jumped-to line before jumping to it */
function JumpToLine()
{
  var lineNum;
  lineNum = window.location.hash;
  lineNum = lineNum.substr(1); /* strip off '#' */

  if (lineNum.indexOf('L') == -1) {
    lineNum = 'L'+lineNum;
  }
  lineElem = document.getElementById(lineNum);
  /* Always jump to new location even if the line was hidden inside a fold, or
   * we corrected the raw number to a line ID.
   */
  if (lineElem) {
    lineElem.scrollIntoView(true);
  }
  return true;
}
if ('onhashchange' in window) {
  window.onhashchange = JumpToLine;
}

-->
</script>
</head>
<body onload='JumpToLine();'>
<pre id='vimCodeElement'>
<span id="L1" class="LineNr"> 1 </span><span class="Comment">/**</span>
<span id="L2" class="LineNr"> 2 </span><span class="Comment"> *</span><span class="SpecialComment"> Created by codeMan on 16/4/14.</span>
<span id="L3" class="LineNr"> 3 </span><span class="Comment"> */</span>
<span id="L4" class="LineNr"> 4 </span><span class="PreProc">import</span> org.bouncycastle.eac.EACIOException;
<span id="L5" class="LineNr"> 5 </span><span class="PreProc">import</span> org.openqa.selenium.By;
<span id="L6" class="LineNr"> 6 </span><span class="PreProc">import</span> org.openqa.selenium.WebDriver;
<span id="L7" class="LineNr"> 7 </span><span class="PreProc">import</span> org.openqa.selenium.firefox.FirefoxDriver;
<span id="L8" class="LineNr"> 8 </span><span class="PreProc">import</span> java.io.BufferedReader;
<span id="L9" class="LineNr"> 9 </span><span class="PreProc">import</span> java.io.FileReader;
<span id="L10" class="LineNr">10 </span><span class="PreProc">import</span> java.io.FileWriter;
<span id="L11" class="LineNr">11 </span>
<span id="L12" class="LineNr">12 </span><span class="StorageClass">public</span> <span class="StorageClass">class</span> TestTheEmail {
<span id="L13" class="LineNr">13 </span>
<span id="L14" class="LineNr">14 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> String URL = <span class="String">&quot;<a href="http://www.ncfxy.com">http://www.ncfxy.com</a>&quot;</span>;
<span id="L15" class="LineNr">15 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> String fileName = <span class="String">&quot;fromNet.txt&quot;</span>;
<span id="L16" class="LineNr">16 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> String fileName2 = <span class="String">&quot;info.csv&quot;</span>;
<span id="L17" class="LineNr">17 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> FileWriter writer = <span class="Constant">null</span>;
<span id="L18" class="LineNr">18 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> String normalHead = <span class="String">&quot;3013&quot;</span>;
<span id="L19" class="LineNr">19 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> String specialHead = <span class="String">&quot;3010&quot;</span>;
<span id="L20" class="LineNr">20 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> <span class="Type">int</span> normalBegin = <span class="Number">218046</span>;
<span id="L21" class="LineNr">21 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> <span class="Type">int</span> normalEnd = <span class="Number">218158</span>;
<span id="L22" class="LineNr">22 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> <span class="Type">int</span> specialNum1 = <span class="Number">218119</span>;
<span id="L23" class="LineNr">23 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> <span class="Type">int</span> specialNum2 = <span class="Number">211039</span>;
<span id="L24" class="LineNr">24 </span>    <span class="StorageClass">private</span> <span class="StorageClass">static</span> <span class="Type">int</span> specialNum3 = <span class="Number">212086</span>;
<span id="L25" class="LineNr">25 </span>
<span id="L26" class="LineNr">26 </span>    <span class="StorageClass">public</span> <span class="StorageClass">static</span> <span class="Type">void</span> main(String args[]){
<span id="L27" class="LineNr">27 </span>
<span id="L28" class="LineNr">28 </span>        WebDriver dr = <span class="Operator">new</span> FirefoxDriver();
<span id="L29" class="LineNr">29 </span>
<span id="L30" class="LineNr">30 </span>        <span class="Exception">try</span>{
<span id="L31" class="LineNr">31 </span>            writer = <span class="Operator">new</span> FileWriter(fileName);
<span id="L32" class="LineNr">32 </span>        }<span class="Exception">catch</span> (Exception e){
<span id="L33" class="LineNr">33 </span>            e.printStackTrace();
<span id="L34" class="LineNr">34 </span>        }
<span id="L35" class="LineNr">35 </span>
<span id="L36" class="LineNr">36 </span>        getAndWriteStuendIDAndEmail(specialNum1, specialNum1, writer, dr, specialHead);
<span id="L37" class="LineNr">37 </span>        getAndWriteStuendIDAndEmail(specialNum2, specialNum2, writer, dr, normalHead);
<span id="L38" class="LineNr">38 </span>        getAndWriteStuendIDAndEmail(specialNum3, specialNum3, writer, dr,normalHead);
<span id="L39" class="LineNr">39 </span>        getAndWriteStuendIDAndEmail(normalBegin, normalEnd, writer, dr, normalHead);
<span id="L40" class="LineNr">40 </span>
<span id="L41" class="LineNr">41 </span>        <span class="Exception">try</span> {
<span id="L42" class="LineNr">42 </span>            writer.close();
<span id="L43" class="LineNr">43 </span>        }<span class="Exception">catch</span> (Exception e){
<span id="L44" class="LineNr">44 </span>            e.printStackTrace();
<span id="L45" class="LineNr">45 </span>        }
<span id="L46" class="LineNr">46 </span>
<span id="L47" class="LineNr">47 </span>        dr.quit();
<span id="L48" class="LineNr">48 </span>
<span id="L49" class="LineNr">49 </span>        checkAnswer(fileName2, fileName);
<span id="L50" class="LineNr">50 </span>    }
<span id="L51" class="LineNr">51 </span>
<span id="L52" class="LineNr">52 </span>    <span class="StorageClass">public</span> <span class="StorageClass">static</span> <span class="Type">void</span> getAndWriteStuendIDAndEmail(<span class="Type">int</span> start, <span class="Type">int</span> end,FileWriter wr, WebDriver dr, String head){
<span id="L53" class="LineNr">53 </span>        <span class="Repeat">while</span> (start &lt;= end){
<span id="L54" class="LineNr">54 </span>            dr.get(URL);
<span id="L55" class="LineNr">55 </span>            dr.findElement(By.id(<span class="String">&quot;name&quot;</span>)).sendKeys(<span class="Operator">new</span> CharSequence[]{head + start});
<span id="L56" class="LineNr">56 </span>            dr.findElement(By.id(<span class="String">&quot;pwd&quot;</span>)).sendKeys(<span class="Operator">new</span> CharSequence[]{<span class="String">&quot;&quot;</span> + start});
<span id="L57" class="LineNr">57 </span>            dr.findElement(By.id(<span class="String">&quot;submit&quot;</span>)).click();
<span id="L58" class="LineNr">58 </span>            <span class="Exception">try</span> {
<span id="L59" class="LineNr">59 </span>                String[] temp = dr.findElement(By.id(<span class="String">&quot;table-main&quot;</span>)).getText().split(<span class="String">&quot; |</span><span class="SpecialChar">\n</span><span class="String">&quot;</span>);
<span id="L60" class="LineNr">60 </span>                wr.write(temp[<span class="Number">3</span>] + <span class="String">&quot;,&quot;</span> + temp[<span class="Number">1</span>] + <span class="String">&quot;</span><span class="SpecialChar">\n</span><span class="String">&quot;</span>);
<span id="L61" class="LineNr">61 </span>            } <span class="Exception">catch</span> (Exception e){
<span id="L62" class="LineNr">62 </span>
<span id="L63" class="LineNr">63 </span>            }
<span id="L64" class="LineNr">64 </span>            start++;
<span id="L65" class="LineNr">65 </span>        }
<span id="L66" class="LineNr">66 </span>    }
<span id="L67" class="LineNr">67 </span>
<span id="L68" class="LineNr">68 </span>    <span class="StorageClass">public</span> <span class="StorageClass">static</span> <span class="Type">void</span> checkAnswer(String file1, String file2){
<span id="L69" class="LineNr">69 </span>        <span class="Exception">try</span> {
<span id="L70" class="LineNr">70 </span>            BufferedReader in = <span class="Operator">new</span> BufferedReader(<span class="Operator">new</span> FileReader(file1));
<span id="L71" class="LineNr">71 </span>            BufferedReader in2 = <span class="Operator">new</span> BufferedReader(<span class="Operator">new</span> FileReader(file2));
<span id="L72" class="LineNr">72 </span>            String data = in.readLine();
<span id="L73" class="LineNr">73 </span>            String data2 = in2.readLine();
<span id="L74" class="LineNr">74 </span>
<span id="L75" class="LineNr">75 </span>            <span class="Repeat">while</span> (data != <span class="Constant">null</span> &amp;&amp; data2 != <span class="Constant">null</span>){
<span id="L76" class="LineNr">76 </span>                String[] dataArray = data.split(<span class="String">&quot;,&quot;</span>);
<span id="L77" class="LineNr">77 </span>                String[] dataArray2 = data2.split(<span class="String">&quot;,&quot;</span>);
<span id="L78" class="LineNr">78 </span>                <span class="Type">boolean</span> ans = dataArray[<span class="Number">1</span>].equals(dataArray2[<span class="Number">1</span>]);
<span id="L79" class="LineNr">79 </span>                <span class="Conditional">if</span>(!ans) {
<span id="L80" class="LineNr">80 </span>                    System.out.println(dataArray[<span class="Number">0</span>] + <span class="String">&quot; &quot;</span> + dataArray[<span class="Number">1</span>] + <span class="String">&quot; &quot;</span> + dataArray2[<span class="Number">1</span>] + <span class="String">&quot; &quot;</span> + ans);
<span id="L81" class="LineNr">81 </span>                    data = in.readLine();
<span id="L82" class="LineNr">82 </span>                    data2 = in2.readLine();
<span id="L83" class="LineNr">83 </span>                }
<span id="L84" class="LineNr">84 </span>            }
<span id="L85" class="LineNr">85 </span>        } <span class="Exception">catch</span> (Exception e) {
<span id="L86" class="LineNr">86 </span>            e.printStackTrace();
<span id="L87" class="LineNr">87 </span>        }
<span id="L88" class="LineNr">88 </span>
<span id="L89" class="LineNr">89 </span>    }
<span id="L90" class="LineNr">90 </span>}
<span id="L91" class="LineNr">91 </span>
<span id="L92" class="LineNr">92 </span>
<span id="L93" class="LineNr">93 </span>
<span id="L94" class="LineNr">94 </span>
</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->

<ul>
<li>将代码提交到Github上：<br><img src="/images/selenium/tupian6.png" alt=""></li>
</ul>

  </section>

</article>



            <footer class="footer">
    <span class="footer__copyright">
        本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
    </span>
    <span class="footer__copyright">
        基于 <a href="http://hexo.io">Hexo</a> 搭建，感谢 <a href="https://pages.github.com/">GitHub Pages</a> 提供免费的托管服务
    </span>
    <span class="footer__copyright">
        &copy; 2016 - 本站由 <a href="/">@王小惟</a> 创建,
        使用<a href="https://github.com/lenbo-ma/hexo-theme-vno">hexo-theme-vno</a>主题,
        修改自<a href="http://github.com/onevcat/vno" target="_blank">Vno</a>
    </span>
</footer>

        </div>
    </div>

    <script src="http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-42596364-1', 'auto');
	ga('send', 'pageview');
</script>

</body>
</html>
